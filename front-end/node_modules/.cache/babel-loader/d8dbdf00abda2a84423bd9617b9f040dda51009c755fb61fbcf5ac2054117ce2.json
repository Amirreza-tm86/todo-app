{"ast":null,"code":"const jwt = require('jsonwebtoken');\nconst user = require('../models/userlogin');\nconst requireAuth = async (req, res, next) => {\n  // verify user is authenticated\n  const {\n    authorization\n  } = req.headers;\n  if (!authorization) {\n    return res.status(401).json({\n      error: 'Authorization token required'\n    });\n  }\n  const token = authorization.split(' ')[1];\n  try {\n    const {\n      _id\n    } = jwt.verify(token, process.env.TOKEN);\n    req.user = await user.findOne({\n      _id\n    }).select('_id');\n    next();\n  } catch (error) {\n    console.log(error);\n    res.status(401).json({\n      error: 'Request is not authorized'\n    });\n  }\n};\nmodule.exports = requireAuth;","map":{"version":3,"names":["jwt","require","user","requireAuth","req","res","next","authorization","headers","status","json","error","token","split","_id","verify","process","env","TOKEN","findOne","select","console","log","module","exports"],"sources":["/home/amirrezatahmasebi/Documents/node-js/backend/middleware/requireAuth.js"],"sourcesContent":["const jwt = require('jsonwebtoken')\nconst user = require('../models/userlogin')\n\nconst requireAuth = async (req, res, next) => {\n    // verify user is authenticated\n    const { authorization } = req.headers\n\n    if (!authorization) {\n        return res.status(401).json({ error: 'Authorization token required' })\n    }\n\n    const token = authorization.split(' ')[1]\n\n    try {\n        const { _id } = jwt.verify(token, process.env.TOKEN)\n\n        req.user = await user.findOne({ _id }).select('_id')\n        next()\n\n    } catch (error) {\n        console.log(error)\n        res.status(401).json({ error: 'Request is not authorized' })\n    }\n}\n\nmodule.exports = requireAuth"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AACnC,MAAMC,IAAI,GAAGD,OAAO,CAAC,qBAAqB,CAAC;AAE3C,MAAME,WAAW,GAAG,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1C;EACA,MAAM;IAAEC;EAAc,CAAC,GAAGH,GAAG,CAACI,OAAO;EAErC,IAAI,CAACD,aAAa,EAAE;IAChB,OAAOF,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,KAAK,EAAE;IAA+B,CAAC,CAAC;EAC1E;EAEA,MAAMC,KAAK,GAAGL,aAAa,CAACM,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAEzC,IAAI;IACA,MAAM;MAAEC;IAAI,CAAC,GAAGd,GAAG,CAACe,MAAM,CAACH,KAAK,EAAEI,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IAEpDd,GAAG,CAACF,IAAI,GAAG,MAAMA,IAAI,CAACiB,OAAO,CAAC;MAAEL;IAAI,CAAC,CAAC,CAACM,MAAM,CAAC,KAAK,CAAC;IACpDd,IAAI,EAAE;EAEV,CAAC,CAAC,OAAOK,KAAK,EAAE;IACZU,OAAO,CAACC,GAAG,CAACX,KAAK,CAAC;IAClBN,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,KAAK,EAAE;IAA4B,CAAC,CAAC;EAChE;AACJ,CAAC;AAEDY,MAAM,CAACC,OAAO,GAAGrB,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}